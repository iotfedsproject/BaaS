const path = require('path');
require('dotenv').config({path: path.resolve("/opt/nodemailer/node_modules/dotenv", "config.env")});

const nodemailer = require('nodemailer');

let transport = nodemailer.createTransport({
   host: 'smtp.gmail.com',
   port: 465,
   secure: true,
   auth: {
     user: process.env.EMAIL_USERNAME,
     pass: process.env.EMAIL_PASSWORD
   }
});

var maillist = [
   'mmitsakias@gmail.com',
];

const mailOptions = {
    from: 'iotfederations@gmail.com', // Sender address
    to: maillist, // List of recipients
    subject: 'IoTFeds Values Your Opinion', // Subject line
    html: '<p>Dear IoTFeds User,</p><p>Please take a moment to cast your vote through this <a href="http://www.iotfeds.gr/">link</a>!</p>',
    attachments: [
       { path: path.resolve("/opt/nodemailer/node_modules/nodemailer/img", "iotfeds-logo.png") }
    ]
};

transport.sendMail(mailOptions, function(err, info) {
   if (err) {
     console.log(err)
   } else {
     console.log(info);
   }
});
